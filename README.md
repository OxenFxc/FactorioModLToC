# 异星工厂模组汉化工具

这是一个专门用于异星工厂(Factorio)模组汉化的工具，可以帮助你批量处理模组的语言文件，无需手动解压缩模组文件。

## 功能特点

- 🔍 **自动扫描模组** - 自动扫描Factorio模组目录下的所有zip文件
- 📋 **语言支持检测** - 显示每个模组当前支持的语言，突出显示需要汉化的模组
- ✏️ **在线编辑** - 双击模组直接进入编辑界面，支持左右对照编辑
- 💾 **直接保存** - 编辑完成后直接保存回ZIP文件，无需手动打包
- 🔄 **操作模式** - 支持新建中文文件或替换现有文件两种模式
- 🗂️ **自动备份** - 保存前自动备份原文件，确保安全
- 📤 **文件导出** - 可以导出源文件和目标文件到本地，方便AI翻译等外部工具处理
- 📥 **文件导入** - 支持从本地导入翻译文件，直接替换编辑区内容
- ⚙️ **路径管理** - 可设置默认导出路径，一键导出到指定位置
- 🔍 **实时搜索** - 支持模组名称实时搜索，快速定位目标模组
- 📋 **备份管理** - 显示所有备份文件，支持双击还原或右键删除备份

## 使用方法

### 1. 运行程序
```bash
python factorio_mod_localizer.py
```

### 2. 扫描模组
- 程序启动后会自动扫描默认的Factorio模组目录：`C:\Users\[用户名]\AppData\Roaming\Factorio\mods`
- 如果你的模组在其他位置，可以点击"浏览"按钮选择目录
- 点击"扫描模组"按钮重新扫描
- 扫描会显示所有 `.zip` 模组文件和 `.zip.backup` 备份文件

### 2.5. 搜索模组
- 在搜索框中输入模组名称的任意部分
- 支持实时搜索，无需按回车
- 可以搜索模组的文件名、显示名称等
- 点击"清除"或"显示全部"返回完整列表

### 3. 编辑模组
- 在模组列表中**双击**需要汉化的模组
- 选择源语言（通常选择英语 en）
- 选择目标语言（通常选择简体中文 zh-CN）
- 选择操作模式：
  - **新建汉化文件**：创建新的中文语言文件
  - **替换现有文件**：如果已有中文文件则编辑现有文件
- 选择要编辑的语言文件（如 strings.cfg）
- 点击"加载文件"

### 4. 编辑翻译
- 设置导出路径（可选）：设置翻译文件的导出位置，点击"设为默认"保存设置
- 选择文件：从下拉列表中选择要编辑的语言文件（如 strings.cfg）
- 点击"加载文件"：加载源文件和目标文件内容
- 左侧显示原文（只读），右侧编辑译文
- 可以点击"预览更改"查看将要保存的内容

### 5. 文件导出导入（AI翻译工作流）
- **导出源文件**：将英文或其他源语言文件导出到本地，方便给AI翻译
- **导出目标文件**：将当前编辑的翻译内容导出到本地
- **从本地导入**：将AI翻译好的文件导入到编辑器中
- 导出的文件会自动命名为：`模组名_语言_文件名.cfg`

### 6. 保存文件
- 点击"保存到ZIP"将翻译保存回模组文件
- 程序会自动创建备份文件（.zip.backup）
- 保存后会自动更新模组的语言支持信息
- 保存成功后自动返回模组列表

### 7. 备份文件管理
- 备份文件在列表中以 `[备份] 模组名` 的格式显示
- **双击备份文件**：选择是否还原备份（会替换或重命名为原文件）
- **右键备份文件**：显示上下文菜单
  - 还原备份：与双击相同功能
  - 删除备份：永久删除备份文件（无法撤销）

## 界面说明

### 主界面
- **模组目录**：设置Factorio模组所在目录
- **搜索模组**：实时搜索模组名称，支持部分匹配
- **模组列表**：显示所有扫描到的模组及其语言支持情况
  - 普通模组：直接显示模组名称
  - 备份文件：以 `[备份] 模组名` 格式显示
  - 双击编辑模组或还原备份
  - 右键显示上下文菜单
- **操作按钮**：
  - 查看语言详情：查看模组详细的语言支持信息
  - 打开缓存目录：打开临时文件缓存目录
  - 清理缓存：清理临时文件
  - 返回模组列表：从编辑界面返回主界面

### 编辑界面
- **模组信息**：显示当前编辑模组的基本信息
- **语言文件选择**：选择源语言、目标语言和操作模式
- **导出路径设置**：设置文件导出位置，支持保存为默认路径
- **文件选择**：选择要编辑的具体语言文件
- **文件操作按钮**：
  - 导出源文件：导出原语言文件供AI翻译
  - 导出目标文件：导出当前编辑内容
  - 从本地导入：导入AI翻译好的文件
- **编辑区域**：左右对照的编辑界面
- **操作按钮**：保存到ZIP、预览更改

## 注意事项

1. **备份重要性**：虽然程序会自动备份，但建议在大量修改前手动备份整个模组目录
2. **编码问题**：如果遇到中文显示问题，请确保使用UTF-8编码
3. **文件格式**：语言文件通常是 .cfg 格式，请保持原有的格式和结构
4. **权限问题**：确保程序有读写模组目录的权限

## 支持的语言代码

- `zh-CN`: 简体中文
- `zh-TW`: 繁体中文
- `en`: 英语
- `ja`: 日语
- `ko`: 韩语
- `ru`: 俄语
- 等等...

## 故障排除

**Q: 程序启动后看不到任何模组？**
A: 检查模组目录路径是否正确，确保目录中有 .zip 格式的模组文件。

**Q: 双击模组没有反应？**
A: 确保模组包含语言文件（locale目录），一些模组可能没有可翻译的文本。

**Q: 保存时出现错误？**
A: 检查文件权限，确保程序可以写入模组目录。也可能是磁盘空间不足。

**Q: 中文显示乱码？**
A: 检查系统区域设置，确保支持UTF-8编码。

## AI翻译工作流示例

### 使用ChatGPT/Claude等AI翻译的完整流程：

1. **准备阶段**：
   - 双击需要汉化的模组进入编辑界面
   - 设置导出路径（如桌面的 factorio_exports 文件夹）
   - 选择源语言为 `en`（英语），目标语言为 `zh-CN`（简体中文）

2. **导出源文件**：
   - 选择要翻译的文件（如 strings.cfg）
   - 点击"加载文件"确保文件正确加载
   - 点击"导出源文件"，将英文文件导出到设定路径

3. **AI翻译**：
   - 打开导出的英文文件（如 `mod-name_en_strings.cfg`）
   - 复制文件内容到ChatGPT/Claude等AI工具
   - 要求AI翻译为中文，保持原有格式不变
   - 将AI翻译结果保存为新文件

4. **导入翻译**：
   - 回到工具，点击"从本地导入"
   - 选择AI翻译好的文件
   - 翻译内容会自动填入右侧编辑区

5. **审核和保存**：
   - 在右侧编辑区审核和调整翻译
   - 点击"预览更改"检查最终效果
   - 点击"保存到ZIP"完成汉化

这种工作流程特别适合大型模组的批量翻译！

## 技术信息

- 开发语言：Python 3.x
- GUI框架：tkinter
- 依赖：仅使用Python标准库
- 支持平台：Windows（主要测试平台）

## 更新日志

### v1.2.0
- 🔍 新增实时搜索功能，支持模组名称快速定位
- 📋 新增备份文件管理功能
  - 在模组列表中显示所有 .zip.backup 备份文件
  - 双击备份文件可选择还原
  - 右键备份文件可删除备份
- 🔄 保存文件后自动返回模组列表
- ✨ 搜索功能支持模组文件名、显示名称、内部名称多重匹配
- 🛠️ 优化界面布局，增加搜索控件

### v1.1.0
- 🔧 修复加载文件功能无效的问题
- 🔧 修复源语言选择空白的问题
- 🆕 新增文件导出功能（导出源文件、导出目标文件）
- 🆕 新增文件导入功能（从本地导入翻译文件）
- 🆕 新增导出路径管理（可设置默认导出路径）
- 🆕 新增配置文件保存功能
- 🆕 完整的AI翻译工作流支持
- ✨ 增强的错误处理和用户反馈
- 📖 完善的调试信息输出

### v1.0.0
- 初始版本发布
- 支持基本的模组扫描和语言文件编辑
- 支持直接修改ZIP文件中的语言文件
- 自动备份功能

---

**注意**：此工具专为异星工厂模组汉化设计，请遵守相关模组的许可协议。 